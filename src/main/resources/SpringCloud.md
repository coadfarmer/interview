### 使用SpringCloud有什么优势？

1. 微服务架构：SpringCloud提供了一套完整的微服务架构解决方案，包括服务注册与发现、服务治理、配置管理、负载均衡、断路器等，可以快速构建大规模的分布式系统。
2. 开箱即用：SpringCloud提供了一系列开箱即用的组件，可以直接在应用中使用，如Eureka、Zuul、Hystrix等，可以大幅度降低开发人员的开发难度和复杂度。
3. 生态丰富：SpringCloud生态系统非常丰富，可以与其他Spring组件、开源软件和云服务无缝集成，如Spring Boot、Netflix OSS、Kubernetes等，可以灵活地构建各种应用场景。
4. 可扩展性强：SpringCloud提供了很好的扩展性和可定制性，可以根据业务需求和系统规模进行定制化开发和扩展。
5. 文档丰富：SpringCloud的官方文档非常详细，覆盖了各个组件的使用方法、示例代码等，开发人员可以快速学习和掌握。

总的来说，SpringCloud提供了一套完整的、易用的、高可扩展性的微服务解决方案，可以帮助开发人员快速构建大规模的分布式系统。

### 什么是微服务

**微服务**是一种架构风格，它将应用程序划分为一组小型的、独立部署的服务，每个服务运行在自己的进程中，通过轻量级的通信机制互相协作，构建大规模、复杂的分布式系统。每个微服务都是一个相对独立的单元，可以独立地进行开发、测试、部署、扩展和维护。

### 微服务的优势

1. 灵活性和可扩展性：微服务将应用程序拆分为多个服务，每个服务都是独立部署和扩展的，可以更加灵活地响应业务需求和用户需求。
2. 可靠性和容错性：每个微服务都是相对独立的单元，一个服务的故障不会影响其他服务的正常运行，从而提高了系统的可靠性和容错性。
3. 易于维护和升级：微服务拆分了应用程序，每个服务只负责一小部分功能，因此可以更容易地维护和升级，减少了维护和升级的风险和复杂性。
4. 技术栈多样性：每个微服务都可以使用不同的技术栈和编程语言，可以根据不同的需求选择最适合的技术栈，提高了开发效率和系统性能。

总之，微服务架构是一种灵活、可靠、易于维护的分布式系统架构，适用于大规模、复杂的应用场景。

### 微服务之间是如何独立通讯的

主要有四种：RestFul API，RPC，消息队列。

### RESTful API和RPC有什么区别？

1. 协议：RESTful API 通常基于 HTTP 协议，而 RPC 可以使用不同的协议，如 gRPC 使用的是基于 Protocol Buffers 的二进制协议。
2. 调用方式：RESTful API 使用的是基于 HTTP 方法的请求，如 GET、POST、PUT、DELETE 等，而 RPC 调用则是直接调用函数或方法。
3. 序列化方式：RESTful API 通常使用 JSON 或 XML 进行序列化和反序列化，而 RPC 使用二进制格式进行序列化，具有更高的性能。
4. 跨语言支持：RPC 框架通常具有跨语言的支持，而 RESTful API 的跨语言支持需要使用一些额外的工具或框架。
5. 传输方式：RESTful API 使用的是无状态的请求和响应，而 RPC 通常使用长连接或者长轮询的方式进行传输，可以实现更高效的通信。

### SpringCloud的核心组件

- Spring Cloud Eureka：服务注册与发现
- Spring Cloud Zuul：服务网关
- Spring Cloud Ribbon：客户端负载均衡
- Spring Cloud Feign：声明性的Web服务客户端
- Spring Cloud Hystrix：断路器
- Spring Cloud Config：分布式统一配置管理等20几个框架，开源一直在更新

### SpringCloud和SpringCloudAlibaba有哪些区别？

Spring Cloud 和 Spring Cloud Alibaba 都是构建微服务架构的解决方案，它们之间的主要区别在于：

1. 服务注册中心：Spring Cloud 使用 Netflix Eureka 作为默认的服务注册中心，而 Spring Cloud Alibaba 使用 Nacos 作为默认的服务注册中心。

2. 服务调用方式：Spring Cloud 通过 Ribbon 和 Feign 等组件实现服务之间的调用，而 Spring Cloud Alibaba 则使用 Alibaba 自己的 RPC 框架 Dubbo 作为默认的服务调用方式。

3. 分布式配置中心：Spring Cloud 使用 Spring Cloud Config 作为默认的分布式配置中心，而 Spring Cloud Alibaba 使用 Nacos Config 作为默认的分布式配置中心。

4. 高可用限流降级：Spring Cloud Alibaba 对于高可用限流和降级方面提供了更加丰富的组件和方案，如 Sentinel、Sentinel Dashboard 等。


总的来说，Spring Cloud 更加注重基于 Spring 技术栈构建微服务架构的方案，而 Spring Cloud Alibaba 则更加注重适合在阿里云平台上使用的微服务架构方案，提供了更多的面向生产环境的组件和解决方案。当然，它们也可以互相使用，选择合适的方案取决于具体的需求和场景。

### SpringBoot和SpringCloud的区别？

Spring Boot是一个快速构建Spring应用程序的框架，可以使用最少的配置，快速搭建一个独立的、基于Spring的应用程序。

Spring Cloud是一个用于快速构建分布式系统的工具集，它提供了大量的工具和框架来帮助开发人员快速构建分布式应用程序。Spring Cloud提供了各种功能，包括服务发现、配置管理、负载均衡、断路器、API网关等。

因此，SpringBoot更偏向于快速构建单个应用程序，而SpringCloud则更偏向于构建分布式系统。它们可以结合使用，使用Spring Boot来快速构建独立的服务，然后使用Spring Cloud来实现服务发现、配置管理等分布式系统需要的功能。

### SpringCloud和Dubbo的区别？

Spring Cloud和Dubbo都是常用的分布式服务框架，两者之间有以下区别：

1. 技术选型：Spring Cloud是基于Spring Boot的微服务框架，而Dubbo则是传统的RPC框架。
2. 注册中心：dubbo 是zookeeper springcloud是eureka，也可以是zookeeper
3. 服务网关，dubbo本身没有实现，只能通过其他第三方技术整合，springcloud有Zuul路由网关，作为路由服务器，进行消费者的请求分发,springcloud支持断路器，与git完美集成配置文件支持版本控制，事物总线实现配置文件的更新与服务自动装配等等一系列的微服务架构要素。
4. ### Spring Cloud和[SpringBoot版本](https://so.csdn.net/so/search?q=SpringBoot版本&spm=1001.2101.3001.7020)对应关系

   | Spring Cloud Version | SpringBoot Version |
   | -------------------- | ------------------ |
   | Hoxton               | 2.2.x              |
   | Greenwich            | 2.1.x              |
   | Finchley             | 2.0.x              |
   | Edgware              | 1.5.x              |
   | Dalston              | 1.5.x              |

### 接口限流的方法

1. 固定窗口限流：这种方式是将请求按照时间划分成固定的窗口，然后在每个窗口中限制请求的数量。例如，每秒钟最多只能接受100个请求。缺点是无法处理突发流量。
2. 滑动窗口限流：这种方式是将请求按照时间划分成若干个固定大小的窗口，然后在每个窗口中限制请求的数量。例如，将1秒划分成10个大小相等的窗口，每个窗口中最多只能接受10个请求。缺点是容易出现请求被漏掉的情况。
3. 令牌桶限流：这种方式是通过限制请求的速率来保护服务端。在令牌桶中，每个请求都需要消耗一个令牌，如果没有足够的令牌，则无法进行请求。可以通过调整桶的大小和放令牌的速率来控制请求的速率。缺点是实现起来相对复杂。
4. 漏桶限流：这种方式类似于令牌桶限流，但是不同的是，漏桶是按照固定速率漏水，如果请求进来的速率大于漏水的速率，则请求会被拒绝。这种方式可以有效地控制请求的速率，但是无法应对突发流量

### 什么是服务熔断？

服务熔断的基本思路是：当某个服务调用失败的次数达到一定阈值时，自动切断对该服务的调用，并返回一个错误响应，避免该服务的错误影响到整个系统。在服务熔断的过程中，系统可以返回一个缓存的响应，或者执行一个备用的逻辑，以避免因为故障服务的长时间不可用而影响系统的性能和可用性。

在SpringCloudAlibaba中，主要是依赖Sentinel实现的，我们可以在需要熔断的方法上加上@SentinelResource注解实现。

### 什么是服务降级？

服务降级是一种应对系统峰值流量、提高系统可用性的解决方案，其基本思路是在系统出现异常或者高并发情况下，暂时关闭一些不太重要或者负荷较高的服务或功能，保证核心服务或者功能的正常运行，从而避免整个系统崩溃。

## Eureka

### 服务注册和发现是什么意思？Spring Cloud 如何实现？

当我们开始一个项目时，我们通常在属性文件中进行所有的配置。随着越来越多的服务开发和部署，添加和修改这些属性变得更加复杂。有些服务可能会下降，而某些位置可能会发生变化。手动更改属性可能会产生问题。 Eureka 服务注册和发现可以在这种情况下提供帮助。由于所有服务都在 Eureka 服务器上注册并通过调用 Eureka 服务器完成查找，因此无需处理服务地点的任何更改和处理。

### 什么是Eureka

Eureka作为SpringCloud的服务注册功能服务器，他是服务注册中心，系统中的其他服务使用
Eureka的客户端将其连接到Eureka Service中，并且保持心跳，这样工作人员可以通过Eureka
Service来监控各个微服务是否运行正常。

### 什么是Eureka的自我保护模式

默认情况下，如果Eureka Service在一定时间内没有接收到某个微服务的心跳，Eureka Service会
进入自我保护模式，在该模式下Eureka Service会保护服务注册表中的信息，不在删除注册表中的
数据，当网络故障恢复后，Eureka Servic 节点会自动退出自我保护模式

## Zuul

### 什么是网关?

- 网关相当于一个网络服务架构的入口，所有网络请求必须通过网关转发到具体的服务。

### 网关的作用是什么

- 统一管理微服务请求，权限控制、负载均衡、路由转发、监控、安全控制黑名单和白名单等

### Spring Cloud Zuul的作用

- 统一入口：未全部为服务提供一个唯一的入口，网关起到外部和内部隔离的作用，保障了后台服务的安全性。
- 鉴权校验：识别每个请求的权限，拒绝不符合要求的请求。
- 动态路由：动态的将请求路由到不同的后端集群中。
- 减少客户端与服务端的耦合：服务可以独立发展，通过网关层来做映射

### [网关Zuul、Gateway、nginx的区别](https://www.cnblogs.com/h-c-g/p/15581918.html)

**zuul：**
是Netflix的，早期在微服务中使用较广泛，是基于servlet实现的，阻塞式的api，不支持长连接。
只能同步，不支持异步。
不依赖spring-webflux，可以扩展至其他微服务框架。
内部没有实现限流、负载均衡，其负载均衡的实现是采用 Ribbon + Eureka 来实现本地负载均衡。
代码简单，注释多，易理解。

**Gateway：**
是springcloud自己研制的微服务网关，是基于Spring5构建，，能够实现响应式非阻塞式的Api，支持长连接。
支持异步。
功能更强大，内部实现了限流、负载均衡等，扩展性也更强。Spring Cloud Gateway明确的区分了 Router 和 Filter，并且一个很大的特点是内置了非常多的开箱即用功能，并且都可以通过 SpringBoot 配置或者手工编码链式调用来使用。
依赖于spring-webflux，仅适合于Spring Cloud套件。
代码复杂，注释少。

**nginx：**
C语言编写，采用服务器实现负载均衡，高性能的HTTP和反向代理web服务器。
Nginx适合于服务器端负载均衡,Zuul和gateway 是本地负载均衡，适合微服务中实现网关。Spring Cloud Gateway 天然适合Spring Cloud 生态。

## Ribbon

Ribbon是一个负载均衡框架，它可以与Eureka、Consul等服务治理框架集成使用。Ribbon的主要作用是将客户端的请求分发到多个服务实例中，实现服务的负载均衡，从而提高服务的可用性和性能。

### Hystrix

Hystrix是一个容错框架，主要用于处理分布式系统中的延迟和容错问题。它可以帮助开发人员实现失败快速响应、服务熔断、服务降级等功能，提高系统的可靠性和弹性。在微服务架构中，服务之间的依赖很多，Hystrix可以在服务之间提供一个保护层，避免故障在整个系统中扩散。Hystrix可以实现对服务的监控、熔断、降级等功能，支持异步执行和响应缓存等特性。

### Hystrix有四种防雪崩方式

- 服务降级：接口调用失败就调用本地的方法返回一个空
- 服务熔断：接口调用失败就会进入调用接口提前定义好的一个熔断的方法，返回错误信息
- 服务隔离：隔离服务之间相互影响
- 服务监控：在服务发生调用时,会将每秒请求数、成功请求数等运行指标记录下来。

### 服务雪崩效应

雪崩效应是在大型互联网项目中，当某个服务发生宕机时，调用这个服务的其他服务也会发生宕机，大型项目的微服务之间的调用是互通的，这样就会将服务的不可用逐步扩大到各个其他服务中，从而使整个项目的服务宕机崩溃.发生雪崩效应的原因有以下几点：

1. 单个服务的代码存在bug. 
2. 请求访问量激增导致服务发生崩溃(如大型商城的枪红包，秒杀功能). 
3. 服务器的硬件故障也会导致部分服务不可用.

### 服务降级、熔断、服务隔离

- 服务降级：当客户端请求服务器端的时候，防止客户端一直等待，不会处理业务逻辑代码，直接返回一个友好的提示给客户端。
- 服务熔断是在服务降级的基础上更直接的一种保护方式，当在一个统计时间范围内的请求失败数量达到设定值（requestVolumeThreshold）或当前的请求错误率达到设定的错误率阈值（errorThresholdPercentage）时开启断路，之后的请求直接走fallback方法，在设定时间（sleepWindowInMilliseconds）后尝试恢复。
- 服务隔离就是Hystrix为隔离的服务开启一个独立的线程池，这样在高并发的情况下不会影响其他服务。服务隔离有线程池和信号量两种实现方式，一般使用线程池方式。

### Feign

- Feign 是一个声明web服务客户端，这使得编写web服务客户端更容易
- 他将我们需要调用的服务方法定义成抽象方法保存在本地就可以了，不需要自己构建Http请求
  了，直接调用接口就行了，不过要注意，调用方法要和本地抽象方法的签名完全一致。

## Bus

### 什么是 Spring Cloud Bus？

Spring Cloud Bus是一个用于将分布式系统的节点连接起来的框架，它利用了Spring Boot自动化配置和Spring Cloud Stream的消息传递能力，可以用于在不同的微服务之间传递消息，从而实现微服务之间的解耦和消息广播。

Spring Cloud Bus的核心思想是将一个分布式的集群状态信息全部放在一个地方，然后让每个节点都去那里拿最新的状态信息，这样就可以实现一次性修改多个节点的状态，从而方便地进行微服务架构的管理和运维。

Spring Cloud Bus的主要特点包括：

- 可以基于RabbitMQ或Kafka实现消息传递
- 可以用于实现全局的配置管理
- 可以用于实现服务实例的动态扩缩容
- 可以用于实现分布式锁等功能

## Gateway

Spring Cloud Gateway是Spring Cloud生态系统中的一个API网关，它基于Spring Framework 5，Spring Boot 2和Project Reactor等技术实现了一系列的过滤器，用于对请求进行路由转发、鉴权、限流、重试、统计等一系列操作。它提供了一种简单而有效的方式来管理和保护微服务架构中的API，也可以与Spring Cloud Eureka、Consul、Zookeeper等注册中心和配置中心进行集成。相比于传统的API网关，Spring Cloud Gateway具有更高的性能、更好的可扩展性和更丰富的功能。

## SpringCloudAlibaba

### Nacos

Nacos是一种动态服务发现、配置管理和服务管理平台，可以帮助用户发现、配置和管理Kubernetes和虚拟机环境中的云原生应用程序。Nacos支持多种协议，包括DNS、gRPC、HTTP和UDP，并支持多种语言和框架。Nacos提供了一个Web界面和API，使用户可以轻松地注册、发现和配置微服务。Nacos还提供了一些高级功能，如流量管理、服务熔断、健康检查、动态路由、配置中心等，这些功能可以帮助用户构建更可靠、高效和可扩展的云原生应用程序。

### Nacos与Eureka的区别

1. Nacos支持服务端主动检测提供者状态：临时实例采用心跳模式，非临时实例采用主动检测模式：【正式工每天都会被检查状态，临时工也就心跳检测自己上报状态】
2. 临时实例心跳不正常会被剔除，非临时实例【正式工】则不会被剔除
3. Nacos支持服务列表变更的消息推送模式，服务列表更新更及时
4. Nacos集群默认采用AP(可用)方式，当集群中存在非临时实例时，采用CP(一致性)模式；Eureka采用AP(可用)方式

### SpringCloud LoadBalancer

Spring Cloud LoadBalancer是Spring Cloud中的一个模块，用于客户端负载均衡，它基于Ribbon实现。在服务发现中，服务消费者可以通过服务注册中心发现并调用服务提供者的实例。如果服务提供者的实例有多个，客户端需要进行负载均衡，以实现请求的分发。

Spring Cloud LoadBalancer提供了一个抽象层，让应用程序不必关心底层的负载均衡实现细节，而是使用Spring Cloud LoadBalancer来选择目标实例。它还支持多种负载均衡算法，例如轮询、加权轮询、随机和最少活动数等。

Spring Cloud LoadBalancer具有以下特点：

- 可扩展性：支持自定义的负载均衡算法和服务列表更新方式。
- 透明性：使用Spring Cloud LoadBalancer后，应用程序对负载均衡器的实现细节是透明的。
- 易用性：Spring Cloud LoadBalancer内置了多种负载均衡算法，并提供了默认配置，应用程序无需进行太多配置。
